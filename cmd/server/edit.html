<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

<script>

function bind_function_to_button() {
    $('#btnSubmit').click(function() {
        alert("clicked!");
        var inputVal = $('#bodyfield').val();
        var ocsum = $('#hidden_csum').val();
        $.ajax
        ({
            type: "POST",
            url: '/update/{{.Title}}',
            //contentType: "application/json",
            data: {
               body: inputVal,
               OriginalChecksum: ocsum,
            },
        })
        .done(function(data, textStatus, jqXHR) { // request successful
            console.log("Response data:" + data);
            alert("Success! Response code: " + jqXHR.status);
        })
        .fail(function (jqXHR, textStatus, errorThrown) { // request failed
            alert("AJAX query failed! textStatus:" + textStatus + " HTTP error code: " + errorThrown);
        });
    });
}

function extend_page_edit_lock(){
 $.ajax({
  url: '/lock_page/{{.Title}}',
  type: 'get',
  success: function(response){
   // Perform operation on the return value
  }
 });
}

$(document).ready(function(){
 setInterval(extend_page_edit_lock,1000);

 bind_function_to_button();

});
</script>

<h1>Editing {{.Title}}</h1>

<p>You are currently logged in as: {{.Username}}</p>

<!-- <form action="/update/{{.Title}}" method="POST"> -->

<div><textarea id="bodyfield" rows="20" cols="80">{{printf "%s" .Body}}</textarea></div>
<div><input type="hidden" id="hidden_csum" value="{{.Checksum}}" /></div>
<div> <button id = "btnSubmit" type="button">Update</button></div>
